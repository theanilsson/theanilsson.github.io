<!DOCTYPE HTML>
<html>
	<head>
		<title>Thea Nilsson - Gameplay & Systems Programmer</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="landing is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header" class="alt">
					<h1><a href="index.html">Portfolio by Thea Nilsson</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li>
								<a href="#">Personal Work Highlights<i class="icon solid fab fa-angle-down" style="color: #fff; padding-left: 0.25em;"></i></a>
								<ul>
									<li><a href="specialization.html">Battle Royale Simulation Using Heatmaps</a></li>
									<li><a href="movement.html">Advanced PhysX Based FPS Movement</a></li>
									<li><a href="enemysystem.html">Diablo 3 Inspired Enemy AI System</a></li>
									<li><a href="pathfinding.html">A-Star NavMesh Pathfinding and Funneling</a></li>
									<li><a href="decals.html">Deferred Rendering Decal System</a></li>
								</ul>
							</li>
							<li><a href="groupprojects.html">Group Projects</a></li>
							<li><a href="aboutme.html">About Me</a></li>
							<li>
								<a href="https://github.com/theanilsson" target="_blank" class="fab fa-github" style="font-size: 1.75em; color:#FFF; padding-right: 0.1em;"></a>
							</li>
							<li>
								<a href="https://www.linkedin.com/in/theanilsson/" target="_blank" class="fab fa-linkedin" style="font-size: 1.75em; color:#FFF; padding-left: 0.1em; padding-right: 0.1em;"></a>
							</li>
							<li>
								<a href="mailto:thea.nom.vy@gmail.com" target="_blank" style="padding-left: 0.1em; padding-right: 0.1em; vertical-align: middle;"><img src="images/Email Icon White.png" alt="" style="width: 2em; height: 1.9em;"/></a>
							</li>
							<li>
								<a href="files/Thea Nilsson CV.pdf" target="_blank" style="padding-left: 0.1em; padding-right: 0.1em; vertical-align: middle;"><img src="images/CV Icon White.png" alt="" style="width: 1.35em; height: 1.9em;"/></a>
							</li>
						</ul>						
					</nav>
				</header>

			<!-- Banner -->
				<section id="banner">
					<h2>Thea Nilsson</h2>
					<p>Gameplay & Systems Programmer</p>
				</section>

			<!-- Main -->
			<section id="main" class="container" style="padding-top: 1em; padding-bottom: 0em;">
				<section class="box special" style="padding: 2em 0 2em 0;">
					<header class="major" style="padding: 0;">
						<h2 style="color: #FFC500;">A-Star NavMesh Pathfinding and Funneling</h2>
					</header>
					<span class="image featured" style="width: auto; display: contents;"><img src="images/PathfindingShowcase.gif" alt="" style="width: -webkit-fill-available; justify-self: center; margin: 1.5em 0 2em 0; border-top: #ffffff50 1px solid; border-bottom: #ffffff50 1px solid;"/></span>

					<ul class="actions special" style="margin-bottom: 0;">
						<li><a href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling" target="_blank" class="button alt" style="display: flex;">View the implementation on GitHub<p class="fab fa-github" style="margin: 0 0 0 0.5em; font-size: xx-large; display: flex; align-self: anchor-center;"></p></a></li>
					</ul>
				</section>

				<section class="box special">
					<h4 style="text-align: left; color: #FFC500;">Summary</h4>
					<p style="text-align: left; margin-bottom: 0;">NavMesh is short for navigation mesh. Essentially it's an object that isn't meant to be rendered in the game, made up entirely of polygons sharing at least one edge with the other polygons in the mesh, to be used for finding viable paths between two points in a game world. Most commonly this is done to help AI actors (even if indirectly player controlled) navigate in the game world. NavMesh pathfinding is an essential component to many modern games and A-star is both one of the most efficient and common algorithms used for finding such paths. Once a viable path has been found, regardless which algorithm was used to find it, a smoothing (in this case funneling) algorithm is needed to make the path both more efficient and better looking. This is because pathfinding algorithms usually only find the shortest path via centerpoints of polygons, not the actual shortest path between the start and end points. An actor wandering centerpoint to centerpoint would not only look strange doing so, but also take far longer to get to its goal than it needed to.</p>
				</section>

				<section class="box special">
					<h4 style="text-align: left; color: #FFC500;">From Curiosity to Requirement</h4>
					<p style="text-align: left; margin-bottom: 1em;">I developed the original version of my pathfinding implementation as part of one of my assignments studying algorithms and data structures during spring 2024 at TGA. That initial version got a passing grade despite being very unoptimized and having no smoothing algorithm to speak of. Even so, it piqued my interest both in AI at large and specifically in the algorithms commonly used in AI. So I decided to dive deeper into the subject of pathfinding and hone my skills to write a more advanced and optimized implementation later down the line.</p>
					<p style="text-align: left; margin-bottom: 1em;">When I found some spare time during summer I tried my hand at implementing a smoothing algorithm to go along with the pathfinding, and succeeded with a basic (and inefficient) version using midpoints between triangle centerpoints to make a better looking path. However, once I started using this version in a project of larger size than where I developed it, I quickly realized it would not be good enough if used for more than a few actors at once. It was full of inefficient memory allocations and unnecessary loops over large collections. This along with finding out a few weeks later that an efficient smoothing algorithm would be a requirement in a later group project gave me the resolve I needed to optimize both the pathfinding algorithm itself and the subsequent smoothing algorithm. A week later, after multiple iterations on my pathfinding algorithm and time spent writing a new smoothing algorithm from scratch, I succeeded in producing the algorithms shown here.</p>
					<p style="text-align: left; margin-bottom: 0;">In my opinion, the biggest flaw of my implementation is that it isn't <b class="highlightedtext">thread safe</b>, but I know exactly which modifications I would need to do to make it so if I were to encounter a situation where I need to thread it. My focus when optimizing these algorithms has been to <b class="highlightedtext">make better use of the cache</b>, <b class="highlightedtext">reduce memory overhead</b> and <b class="highlightedtext">eliminate redundant iterations</b>.</p>
				</section>

				<section class="box special">
					<div class="row">
						<div class="col-12">
							<h4 style="text-align: left; color: #FFC500;">A-Star pathfinding</h4>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							<p style="text-align: left; margin-bottom: 1em;">My implementation defines polygons as "nodes" and currently only works on NavMeshes made up entirely of triangles. <b class="highlightedtext">I could adapt it to handle polygons with more sides without too much effort</b>, but using triangle meshes was enough to satisfy my own curiosity and to fulfill the requirements of the projects I needed to use the algorithms in, so I settled for that.</p>
							<p style="text-align: left; margin-bottom: 1em;">The pathfinding algorithm works by traversing a priority queue, sorted by the cost of reaching each node from the starting node, and marking visited nodes along with updating their cost as the algorithm goes along. As the algorithm progresses it tracks which nodes it had to walk through to get to each other node by the shortest path there.</p>
							<span class="image featured" style="width: auto; display: contents;"><img src="images/Astar frontier setup.png" alt="" style="width: -webkit-fill-available; max-width: 716px; justify-self: center; padding: 0 0 0 0; border: 1px solid #fcfcfc50; border-radius: 2px;"/></span>
							<a class="highlightpageanchor2" href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling/blob/main/code/NavMesh.cpp#L143" target="_blank">Go to the snippet on GitHub</a>

							<p style="text-align: left; margin: 2em 0 1em 0;">If the algorithm traverses all nodes by shared edges originating from the start node without reaching its goal, the algorithm fails. This can only happen if a NavMesh was fed to the algorithm where not all triangles share an edge. It could also happen <b class="highlightedtext">if I were to implement a way to make nodes untraversable</b> (driven by gameplay), signifying a blocked or otherwise obstructed path.</p>
							<p style="text-align: left; margin-bottom: 1em;">If the algorithm succeeds in traversing its way to the end node however, it constructs a collection consisting of the shortest path of nodes used to reach the end node from the start node. Using this collection it then constructs a collection of "portals". Portals are synonymous with edges, consisting of two of the triangle's three vertices. The only difference is that a portal has to be an edge the actor would need to walk through to traverse along the path to reach the end. These portals are then fed to the funneling algorithm to produce the final smooth path. <b class="hover_img"><a>The resulting path before any funneling is applied is displayed as the pink line in the visualization shown when hovering over this sentence.<span><img src="images/Astar without funneling.png" alt="image" style="width: auto; max-width: 40em;"/></span></a></b></p>

							<span class="image featured" style="width: auto; display: contents;"><img src="images/Astar found path.png" alt="" style="width: -webkit-fill-available; max-width: 1007px; justify-self: center; padding: 0 0 0 0; border: 1px solid #fcfcfc50; border-radius: 2px;"/></span>
							<a class="highlightpageanchor2" href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling/blob/main/code/NavMesh.cpp#L174" target="_blank">Go to the snippet on GitHub</a>
							<!-- <span class="image featured" style="width: auto; display: contents;"><img src="images/Astar without funneling.png" alt="" style="width: -webkit-fill-available; max-width: 700px; justify-self: center; padding: 0 0 0 0; margin-top: 2em; border: 1px solid #fcfcfc50; border-radius: 2px;"/></span> -->
						</div>
					</div>
				</section>

				<section class="box special">
					<div class="row">
						<div class="col-12">
							<h4 style="text-align: left; color: #FFC500;">Funneling the Found Path</h4>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							<p style="text-align: left; margin-bottom: 1em;">The funneling algorithm essentially functions like plastic cling wrap visually. It tries to wrap the path along corners on the way to the goal without overshooting the corner and "ripping" the cling wrap. Though funneling is a more apt name for the algorithm, since it essentially works by defining cones that it keeps narrowing more and more, which end up looking like funnels.</p>
							<p style="text-align: left; margin-bottom: 1em;">The start of the algorithm works by defining either vertex from the first portal as the apex of the funnel (they are assumed to be the same and that is always the case in my implementation) and the left and right points of the second portal as the left and right points of the funnel, essentially defining two edges, one spanning from the left to the apex and one spanning from the right to the apex, forming a cone.</p>
							<span class="image featured" style="width: auto; display: contents;"><img src="images/Astar apex.png" alt="" style="width: -webkit-fill-available; max-width: 810px; justify-self: center; padding: 0 0 0 0; border: 1px solid #fcfcfc50; border-radius: 2px;"/></span>
							<a class="highlightpageanchor2" href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling/blob/main/code/NavMesh.cpp#L287" target="_blank">Go to the snippet on GitHub</a>
							<p style="text-align: left; margin: 1em 0 1em 0;">Then the traversing of the path of portals begins. Stepping along the sorted path of portals, the algorithm checks if the portal's left point is a better left point for the funnel to use without overshooting the right point, and vice versa for the right portal point to the right funnel point. If the left or right points of the portal were to make the funnel overshoot (meaning the right point of the funnel would be to the left of the left point or vice versa), that means a corner for the final smooth path has been found and the algorithm should define a new funnel apex and new left and right points using the next portal following the one where the corner point was found on. Once the iteration reaches the final portal, the best smooth path has always been found and we can allow the actor to traverse along it. <b class="hover_img"><a>The resulting smoothed path is displayed as the pink line in the visualization shown when hovering over this sentence.<span><img src="images/Astar funneled.png" alt="image" style="width: auto; max-width: 40em;"/></span></a></b></p>
							<span class="image featured" style="width: auto; display: contents;"><img src="images/Astar funneling iterations.png" alt="" style="width: -webkit-fill-available; max-width: 636px; justify-self: center; padding: 0 0 0 0; border: 1px solid #fcfcfc50; border-radius: 2px;"/></span>
							<a class="highlightpageanchor2" href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling/blob/main/code/NavMesh.cpp#L336" target="_blank">Go to the snippet on GitHub</a>
						</div>
					</div>
				</section>

				<section class="box special">
					<ul class="actions special" style="margin-bottom: 0;">
						<li><a href="https://github.com/theanilsson/Astar-Navmesh-Pathfinding-and-Funneling" target="_blank" class="button alt" style="display: flex;">View the implementation on GitHub<p class="fab fa-github" style="margin: 0 0 0 0.5em; font-size: xx-large; display: flex; align-self: anchor-center;"></p></a></li>
					</ul>
				</section>
			</section>

			<!-- Footer -->
				<footer id="footer">
					<ul style="list-style-type: none;">
						<li>
							<a href="https://github.com/theanilsson" target="_blank" class="fab fa-github" style="font-size: 1.75em; color:#FFF; padding-right: 0.1em; border-bottom: none; vertical-align: middle;"></a>
							<a href="https://www.linkedin.com/in/theanilsson/" target="_blank" class="fab fa-linkedin" style="font-size: 1.75em; color:#FFF; padding-left: 0.1em; padding-right: 0.1em; border-bottom: none; vertical-align: middle;"></a>
							<a href="mailto:thea.nom.vy@gmail.com" target="_blank" style="padding-left: 0.1em; padding-right: 0.1em; vertical-align: middle; border-bottom: none; vertical-align: middle;"><img src="images/Email Icon White.png" alt="" style="width: 2em; height: 1.9em; vertical-align: middle;"/></a>
							<a href="files/Thea Nilsson CV.pdf" target="_blank" style="padding-left: 0.1em; padding-right: 0.1em; vertical-align: middle; border-bottom: none; vertical-align: middle;"><img src="images/CV Icon White.png" alt="" style="width: 1.35em; height: 1.9em; vertical-align: middle;"/></a>
						</li>
					</ul>
					<ul style="list-style-type: none;">
						<li style="margin-bottom: 1em; color: #FF7FE8; font-size: 0.8em;">This website was designed & developed by Thea Nilsson using only HTML & CSS</li>
						<li style="color: #FF7FE8; font-size: 0.8em;">The initial website framework was based on a template by <a style="border-bottom: none; font-size: inherit;" class="highlightpageanchor2" href="http://html5up.net" target="_blank">HTML5 UP</a></li>
					</ul>
				</footer>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>